var baidu_dangle_apk_url="https://res9.d.cn/bf/baidungdcn/dlyxzx_109549.apk?f=wap";$(function(){$(".load").hide();$(".goTop").hide();$(".goTop").bind("click",function(){$("html,body").animate({scrollTop:0},500)});var slideBtm=$(".morenav"),navmore=$(".navmore");slideBtm.on("click",function(){var $this=$(this);if(!$this.hasClass("curr")){$this.addClass("curr");navmore.slideDown()}else{$this.removeClass("curr");navmore.slideUp()}})});$(window).bind("scroll",function(){var scrollTop=$(this).scrollTop();if(scrollTop>300){$(".goTop").show()}else{$(".goTop").hide()}});$(function(){var $logo=$("div.topmore");var $ul=$(".hide-nav");var $cover=$("div.cover-1");var $ula=$(".hide-nav li a");$logo.on("click",function(){$("div.cover-1").toggle();$(".hide-nav").slideToggle()});$cover.bind("click",function(e){$("div.cover-1").toggle();$(".hide-nav").slideToggle()})});function getTestGamePage(pageNo,pageCnt){var pageNo=pageNo;var pageCnt=pageCnt;$(".load").show();if($("input[name='pageCnt']:last").val()!=null&&$("input[name='pageCnt']:last").val()!=""){pageCnt=$("input[name='pageCnt']:last").val()}if($("input[name='pageNo']:last").val()!=null&&$("input[name='pageNo']:last").val()!=""){pageNo=$("input[name='pageNo']:last").val()}var lastday=$("div h2:last span").text().replace(/(^\s*)|(\s*$)/g,"");var type=$("input[name='type']").val();var offType=$("input[name='offType']").val();$(".page:last").load(contextRoot+"/channel/asyPageGames_"+pageNo+".html",{lastDay:lastday,type:type,offType:offType},function(response,status,xhr){if(status=="error"){var msg="Sorry but there was an error: ";$("#error").html(msg+xhr.status+" "+xhr.statusText)}else{if(pageNo==pageCnt){$(".exit").hide();$(".notexit").show()}else{$(".exit").show();$(".notexit").hide()}$(".page:last").after("<div class='page'></div>");$(".load").hide()}})}var touchmove=function(e){e.preventDefault&&e.preventDefault();e.returnValue=false;e.stopPropagation&&e.stopPropagation();return false};var defaultEvent;var scr=function(e){defaultEvent=e;e.preventDefault&&e.preventDefault();e.returnValue=false;e.stopPropagation&&e.stopPropagation();return false};function showDown(channelId){var ua=window.navigator.userAgent.toLowerCase();if(ua.match(/MicroMessenger/i)=="micromessenger"){window.scrollTo(0,0);$(".wx-banner").css("display","block");$(".wx-img").css("display","block");$("body,html").css("overflow-y","hidden");return}var u=window.navigator.userAgent,isAndroid=u.indexOf("Android")>-1||u.indexOf("Adr")>-1,isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);toUrl="/api/download/games.json?channelId="+channelId;$.ajax({url:toUrl,type:"GET",cache:false,dataType:"json",success:function(data){if(data!=null){if(isiOS&&data.ios==null){alert("暂无IOS下载包");return false}if(isAndroid&&data.android==null){alert("暂无Android下载包");return}$(document).on("touchmove",function(){return false});$(document).on("mousewheel DOMMouseScroll",function(e){return false});var resourceId=data.resourceId;var channelId=data.channelId;var recommend=data.recommend;if(recommend!=null){$("#tj").html(recommend);$("#tj").show();$("#tip").show()}else{$("#tj").hide();$("#tip").hide()}if(isiOS){$("#gsload").hide()}else{$("#gsload").attr("href","dlapp://com.diguayouxi/gamedetail?resType="+resourceId+"&resId="+channelId)}$("#gsload").on("click",function(){if(!isFromBaiduSerach()){$(".app").fadeIn(500)}});$(".cancel").on("click",function(){$(".app").fadeOut(500)});$(".close").on("click",function(){$(".web-download,.full").fadeOut(500);$(".app").fadeOut(500);$(document).off("touchmove mousewheel DOMMouseScroll")});$(".full").on("click",function(){$(".web-download,.full").fadeOut(500);$(".app").fadeOut(500);$(document).off("touchmove mousewheel DOMMouseScroll")});if(data.android!=null){var androidurl=data.android.url;$("#tit").text(data.android.ChannelName);$("#ptload").attr("href",androidurl);$("#ptload").text(data.android.androidPkg);$("#descload").text(data.android.systemDesc);$("#ptload").show();$("#descload").show()}else{$("#ptload").hide();$("#descload").hide()}if(data.ios!=null){var iosurl=data.ios.url;$("#tit").text(data.ios.ChannelName);$("#iosload").attr("href",iosurl);$("#iosload").text(data.ios.iosPkg);$("#iosload").show();$("#iosspan").show()}else{$("#iosload").hide();$("#iosspan").hide()}if(isFromBaiduSerach()){$(".web-download #ptload").hide();$(".web-download .app a").css({"margin-top":"5px"});$(".web-download #gsload").html("安装当乐App").attr("href",baidu_dangle_apk_url);$(".web-download #descload").html("使用当乐App下载").css({"text-align":"center"}).parent().append($(".web-download #gsload"));$(".web-download #commsg,.web-download #tj,.web-download p").hide()}$(".web-download,.full").fadeIn(500)}else{$(".web-download,.full").hide();alert("暂无下载包")}},error:function(){error=1}})}function getLocaltionParam(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null){return unescape(r[2])}return null}function isFromBaiduSerach(){return getLocaltionParam("source")=="baidu"}function downLoadGame(channelId){var toUrl=contextRoot+"/api/download/games.json?channelId="+channelId;$.ajax({url:toUrl,type:"GET",cache:false,dataType:"json",success:function(data){if(data!=null){var u=window.navigator.userAgent,isAndroid=u.indexOf("Android")>-1||u.indexOf("Adr")>-1,isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);var url=null;if(isiOS&&data.ios==null){alert("暂无IOS下载包");return false}if(isAndroid&&data.android==null){alert("暂无Android下载包");return}if(isAndroid&&data.android!=null){url=data.android.url}else{if(isiOS&&data.ios!=null){url=data.ios.url}}if(url!=null){window.location=url}else{alert("暂无下载包")}}}})}$(document).on("click",".wx-banner,.wx-img",function(){$(".wx-banner,.wx-img").hide();$("body,html").css("overflow-y","auto")});function hideFloatingLayer(){$(".gmdetaDown,.full").fadeOut(1000);window.removeEventListener("ontouchmove",touchmove,false);document.body.parentNode.style.overflow="auto"}function getScrollTop(){var scrollPos;if(window.pageYOffset){scrollPos=window.pageYOffset}else{if(document.compatMode&&document.compatMode!="BackCompat"){scrollPos=document.documentElement.scrollTop}else{if(document.body){scrollPos=document.body.scrollTop}}}return scrollPos}var keyword;function inText(elem){if(keyword==null||keyword==$(elem).val()){keyword=$(elem).val();$(elem).val("")}}function outText(elem){if($(elem).val().length==0){$(elem).val(keyword);keyword=null}}function check(){var u=window.navigator.userAgent,isAndroid=u.indexOf("Android")>-1||u.indexOf("Adr")>-1,isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);if(isAndroid){}else{if(isiOS){}else{if(window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)=="micromessenger"){window.scrollTo(0,0);$(".wx-banner").css("display","block");$(".wx-img").css("display","block");$("body,html").css("overflow-y","hidden")}}}};